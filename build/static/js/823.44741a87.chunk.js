"use strict";(self.webpackChunkreact_complete_guide=self.webpackChunkreact_complete_guide||[]).push([[823],{366:(e,t,n)=>{n.d(t,{A:()=>c});var s=n(43);function o(e,t){return"SEND"===t.type?{data:null,error:null,status:"pending"}:"SUCCESS"===t.type?{data:t.responseData,error:null,status:"completed"}:"ERROR"===t.type?{data:null,error:t.errorMessage,status:"completed"}:e}const c=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const[n,c]=(0,s.useReducer)(o,{status:t?"pending":null,data:null,error:null});return{sendRequest:(0,s.useCallback)((async function(t){c({type:"SEND"});try{const n=await e(t);c({type:"SUCCESS",responseData:n})}catch(n){c({type:"ERROR",errorMessage:n.message||"Something went wrong!"})}}),[e]),...n}}},989:(e,t,n)=>{n.d(t,{BC:()=>r,Ow:()=>d,dB:()=>o,kr:()=>a,zt:()=>c});const s="https://quotes-35d3e-default-rtdb.firebaseio.com";async function o(){const e=await fetch("".concat(s,"/quotes.json")),t=await e.json();if(!e.ok)throw new Error(t.message||"Could not fetch quotes.");const n=[];for(const s in t){const e={id:s,...t[s]};n.push(e)}return n}async function c(e){const t=await fetch("".concat(s,"/quotes/").concat(e,".json")),n=await t.json();if(!t.ok)throw new Error(n.message||"Could not fetch quote.");return{id:e,...n}}async function a(e){const t=await fetch("".concat(s,"/quotes.json"),{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}),n=await t.json();if(!t.ok)throw new Error(n.message||"Could not create quote.");return null}async function r(e){const t=await fetch("".concat(s,"/comments/").concat(e.quoteId,".json"),{method:"POST",body:JSON.stringify(e.commentData),headers:{"Content-Type":"application/json"}}),n=await t.json();if(!t.ok)throw new Error(n.message||"Could not add comment.");return{commentId:n.name}}async function d(e){const t=await fetch("".concat(s,"/comments/").concat(e,".json")),n=await t.json();if(!t.ok)throw new Error(n.message||"Could not get comments.");const o=[];for(const s in n){const e={id:s,...n[s]};o.push(e)}return o}},823:(e,t,n)=>{n.r(t),n.d(t,{default:()=>N});var s=n(43),o=n(323);const c="Comments_comments__qHDbt",a="NewCommentForm_form__ItviR",r="NewCommentForm_control__5k+Wh",d="NewCommentForm_actions__3BzpP";var m=n(366),i=n(989),l=n(149),u=n(579);const h=e=>{const t=(0,s.useRef)(),{sendRequest:n,status:o,error:c}=(0,m.A)(i.BC),{onAddedComment:h}=e;(0,s.useEffect)((()=>{"completed"!==o||c||h()}),[o,c,h]);const j=s=>{s.preventDefault();const o=t.current.value;n({commentData:{text:o},quoteId:e.quoteId})};return(0,u.jsxs)("form",{className:a,onSubmit:j,children:["pending"===o&&(0,u.jsx)("div",{className:"centered",children:(0,u.jsx)(l.A,{})}),(0,u.jsxs)("div",{className:r,onSubmit:j,children:[(0,u.jsx)("label",{htmlFor:"comment",children:"Your Comment"}),(0,u.jsx)("textarea",{id:"comment",rows:"5",ref:t})]}),(0,u.jsx)("div",{className:d,children:(0,u.jsx)("button",{className:"btn",children:"Add Comment"})})]})},j="CommentItem_item__f0hY9",f=e=>(0,u.jsx)("li",{className:j,children:(0,u.jsx)("p",{children:e.text})}),x="CommentsList_comments__My6xy",p=e=>(0,u.jsx)("ul",{className:x,children:e.comments.map((e=>(0,u.jsx)(f,{text:e.text},e.id)))}),w=()=>{const[e,t]=(0,s.useState)(!1),n=(0,o.g)(),{quoteId:a}=n,{sendRequest:r,status:d,data:j}=(0,m.A)(i.Ow);(0,s.useEffect)((()=>{r(a)}),[a,r]);const f=(0,s.useCallback)((()=>{r(a)}),[r,a]);let x;return"pending"===d&&(x=(0,u.jsx)("div",{className:"centered",children:(0,u.jsx)(l.A,{})})),"completed"===d&&j&&j.length>0&&(x=(0,u.jsx)(p,{comments:j})),"completed"!==d||j&&0!==j.length||(x=(0,u.jsx)("p",{className:"centered",children:"No comments were added yet!"})),(0,u.jsxs)("section",{className:c,children:[(0,u.jsx)("h2",{children:"User Comments"}),!e&&(0,u.jsx)("button",{className:"btn",onClick:()=>{t(!0)},children:"Add a Comment"}),e&&(0,u.jsx)(h,{quoteId:a,onAddedComment:f}),x]})},C="HighlightedQuote_quote__mITvf",g=e=>(0,u.jsxs)("figure",{className:C,children:[(0,u.jsx)("p",{children:e.text}),(0,u.jsx)("figcaption",{children:e.author})]}),N=()=>{const e=(0,o.W5)(),t=(0,o.g)(),{quoteId:n}=t,{sendRequest:c,status:a,data:r,error:d}=(0,m.A)(i.zt,!0);return(0,s.useEffect)((()=>{c(n)}),[c,n]),"pending"===a?(0,u.jsx)("div",{className:"centered",children:(0,u.jsx)(l.A,{})}):d?(0,u.jsx)("p",{className:"centered",children:d}):r.text?(0,u.jsx)("div",{children:(0,u.jsxs)(s.Fragment,{children:[(0,u.jsx)(g,{text:r.text,author:r.author}),(0,u.jsx)(o.qh,{path:e.path,exact:!0,children:(0,u.jsx)("div",{className:"centered",children:(0,u.jsx)(o.N_,{className:"btn--flat",to:"".concat(e.url,"/comments"),children:"Load Comments"})})}),(0,u.jsx)(o.qh,{path:"".concat(e.path,"/comments"),children:(0,u.jsx)(w,{})})]})}):(0,u.jsx)("p",{children:"No quote found!"})}}}]);
//# sourceMappingURL=823.44741a87.chunk.js.map